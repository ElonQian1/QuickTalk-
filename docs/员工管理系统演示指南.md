# 员工管理系统 - 功能演示指南

## 📋 系统概述

QuickTalk 员工管理系统是一个完整的多用户客服协作平台，允许店主邀请其他用户成为自己店铺的客服人员。

### 🎯 核心功能

1. **用户搜索与邀请** - 店主可以搜索系统中的其他用户并发送邀请
2. **角色权限管理** - 支持不同角色：经理、客服、查看者
3. **邀请流程管理** - 完整的邀请→接受/拒绝→员工入职流程
4. **员工状态管理** - 实时监控员工状态和权限

## 🏗️ 技术架构

### 后端 (Rust + Axum)
- **数据库**: SQLite 
- **API架构**: RESTful API + WebSocket
- **权限系统**: 基于角色的访问控制 (RBAC)
- **数据隔离**: 按店铺ID隔离数据访问

### 前端 (HTML5 + JavaScript)
- **响应式设计**: 支持桌面和移动端
- **实时更新**: 动态加载员工和邀请数据
- **用户体验**: 现代化UI/UX设计

## 📊 数据库架构

### 核心表结构
```sql
-- 用户表
users (id, username, email, role, created_at)

-- 员工关系表
employees (id, shop_id, name, email, role, status, created_at)

-- 邀请表
employee_invitations (id, shop_id, inviter_id, invitee_email, role, message, token, status, expires_at, created_at)

-- 权限表
employee_permissions (id, employee_id, permission, granted_at)

-- 用户会话表
user_sessions (id, user_id, session_token, expires_at, created_at)

-- 审计日志表
audit_logs (id, user_id, action, details, created_at)
```

## 🔌 API 端点

### 员工管理
- `GET /api/shops/{shop_id}/employees` - 获取员工列表
- `POST /api/shops/{shop_id}/employees` - 添加员工
- `DELETE /api/shops/{shop_id}/employees/{employee_id}` - 移除员工
- `PUT /api/shops/{shop_id}/employees/{employee_id}` - 更新员工角色

### 邀请管理
- `GET /api/shops/{shop_id}/invitations` - 获取邀请列表
- `POST /api/shops/{shop_id}/invitations` - 发送邀请
- `POST /api/invitations/{token}/accept` - 接受邀请
- `POST /api/invitations/{token}/reject` - 拒绝邀请

### 用户搜索
- `GET /api/users/search?q={keyword}&exclude_shop_id={shop_id}` - 搜索用户

## 🎪 功能演示

### 1. 访问系统
```
浏览器访问: http://localhost:3030/shop-login.html
```

### 2. 店主登录
- 输入店铺ID: `test_shop_001`
- 点击"进入管理界面"
- 系统会显示管理导航链接

### 3. 员工管理界面
```
直接访问: http://localhost:3030/employee-management.html?shop_id=test_shop_001
```

#### 主要功能区域：
- **搜索用户**: 输入用户名或邮箱搜索系统中的用户
- **发送邀请**: 选择角色并发送邀请给指定用户
- **员工列表**: 查看当前店铺的所有员工信息
- **邀请记录**: 查看发送的邀请状态和历史

### 4. 操作流程

#### 邀请新员工：
1. 在搜索框输入用户邮箱或姓名
2. 从搜索结果中选择用户
3. 选择合适的角色（客服/经理/查看者）
4. 点击"快速邀请"或使用详细邀请表单
5. 系统发送邀请邮件（模拟）

#### 管理现有员工：
1. 在"现有员工"标签页查看所有员工
2. 每个员工卡片显示：
   - 基本信息（姓名、邮箱）
   - 角色和状态
   - 加入时间
   - 操作按钮（编辑、移除）

#### 查看邀请记录：
1. 切换到"邀请记录"标签页
2. 查看所有发送的邀请状态
3. 对于待处理的邀请可以重新发送或取消

## 🛡️ 安全特性

### 权限控制
- **店铺隔离**: 每个店主只能管理自己店铺的员工
- **角色验证**: 基于用户角色控制功能访问
- **令牌验证**: 邀请链接使用安全令牌
- **过期机制**: 邀请链接有时效性

### 数据安全
- **输入验证**: 所有用户输入都经过验证
- **SQL注入防护**: 使用参数化查询
- **会话管理**: 安全的用户会话处理
- **审计日志**: 记录所有关键操作

## 📈 扩展功能

### 已实现功能
✅ 用户搜索和邀请  
✅ 多角色权限管理  
✅ 邀请状态追踪  
✅ 员工信息管理  
✅ 数据隔离和安全  

### 可扩展功能
🔄 邮件通知系统  
🔄 批量操作支持  
🔄 高级权限配置  
🔄 员工工作报表  
🔄 客服工作量统计  

## 🚀 部署说明

### 本地开发
```bash
# 启动后端服务器
cd backend
cargo run

# 访问管理界面
浏览器打开: http://localhost:3030/shop-login.html
```

### 生产部署
1. 编译Rust后端
2. 配置SQLite数据库
3. 设置Nginx反向代理
4. 配置SSL证书
5. 启动服务

## 🎯 使用场景

### 典型工作流程

1. **店主注册**: 创建店铺账户
2. **搜索员工**: 在用户库中搜索合适的客服人员
3. **发送邀请**: 向候选人发送角色邀请
4. **处理响应**: 候选人接受或拒绝邀请
5. **员工入职**: 接受邀请后成为店铺员工
6. **权限管理**: 根据需要调整员工角色和权限
7. **日常管理**: 监控员工状态，管理团队

### 角色权限

- **超级管理员**: 全系统访问权限
- **店主**: 管理自己店铺的员工和客服
- **经理**: 管理团队，查看数据报表
- **客服**: 处理客户咨询，回复消息
- **查看者**: 只读访问，查看数据

## 📞 技术支持

如需帮助或发现问题，请：
1. 查看日志文件排查错误
2. 检查API响应状态
3. 验证数据库连接
4. 确认权限配置正确

---

**系统版本**: v2.0.0  
**更新时间**: 2024年1月  
**技术栈**: Rust + Axum + SQLite + HTML5 + JavaScript  
**许可证**: MIT License
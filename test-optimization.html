<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»£ç ä¼˜åŒ–éªŒè¯æµ‹è¯•é¡µé¢</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .header {
            text-align: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        
        .test-section {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .test-section h3 {
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        
        .test-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background-color: #667eea;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #5a6fd8;
        }
        
        .btn-success {
            background-color: #28a745;
            color: white;
        }
        
        .btn-info {
            background-color: #17a2b8;
            color: white;
        }
        
        .btn-warning {
            background-color: #ffc107;
            color: #212529;
        }
        
        .test-output {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        
        .status {
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            font-weight: 500;
        }
        
        .status.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .status.info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        
        .demo-area {
            border: 2px dashed #dee2e6;
            padding: 20px;
            border-radius: 5px;
            min-height: 200px;
        }
        
        #test-messages {
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 10px;
            min-height: 150px;
            max-height: 300px;
            overflow-y: auto;
            background-color: #fafafa;
        }
        
        .message {
            margin: 5px 0;
            padding: 8px 12px;
            border-radius: 18px;
            max-width: 80%;
            word-wrap: break-word;
        }
        
        .message.customer {
            background-color: #e3f2fd;
            align-self: flex-start;
        }
        
        .message.staff {
            background-color: #667eea;
            color: white;
            align-self: flex-end;
            margin-left: auto;
        }
        
        .component-status {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .component-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            text-align: center;
        }
        
        .component-card.loaded {
            border-color: #28a745;
            background-color: #f8fff9;
        }
        
        .component-card.error {
            border-color: #dc3545;
            background-color: #fff5f5;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ§ª QuickTalk ä»£ç ä¼˜åŒ–éªŒè¯æµ‹è¯•</h1>
        <p>éªŒè¯ç»Ÿä¸€ç»„ä»¶çš„åŠŸèƒ½å®Œæ•´æ€§å’Œæ€§èƒ½è¡¨ç°</p>
    </div>

    <!-- ç»„ä»¶çŠ¶æ€æ£€æŸ¥ -->
    <div class="test-section">
        <h3>ğŸ“¦ ç»„ä»¶åŠ è½½çŠ¶æ€</h3>
        <div class="component-status">
            <div class="component-card" id="utils-status">
                <h4>UnifiedUtils</h4>
                <div class="loading"></div>
                <p>æ£€æŸ¥ä¸­...</p>
            </div>
            <div class="component-card" id="websocket-status">
                <h4>UnifiedWebSocketClient</h4>
                <div class="loading"></div>
                <p>æ£€æŸ¥ä¸­...</p>
            </div>
            <div class="component-card" id="message-status">
                <h4>UnifiedMessageManager</h4>
                <div class="loading"></div>
                <p>æ£€æŸ¥ä¸­...</p>
            </div>
        </div>
    </div>

    <!-- å·¥å…·å‡½æ•°æµ‹è¯• -->
    <div class="test-section">
        <h3>ğŸ”§ UnifiedUtils å·¥å…·å‡½æ•°æµ‹è¯•</h3>
        <div class="test-controls">
            <button class="btn btn-primary" onclick="testDeepClone()">æµ‹è¯•æ·±æ‹·è´</button>
            <button class="btn btn-primary" onclick="testDebounce()">æµ‹è¯•é˜²æŠ–</button>
            <button class="btn btn-primary" onclick="testFormatTime()">æµ‹è¯•æ—¶é—´æ ¼å¼åŒ–</button>
            <button class="btn btn-primary" onclick="testFileSize()">æµ‹è¯•æ–‡ä»¶å¤§å°æ ¼å¼åŒ–</button>
            <button class="btn btn-primary" onclick="testValidation()">æµ‹è¯•éªŒè¯å‡½æ•°</button>
        </div>
        <div id="utils-output" class="test-output"></div>
    </div>

    <!-- WebSocketè¿æ¥æµ‹è¯• -->
    <div class="test-section">
        <h3>ğŸ”Œ UnifiedWebSocketClient è¿æ¥æµ‹è¯•</h3>
        <div class="test-controls">
            <button class="btn btn-success" onclick="testWebSocketConnection()">æµ‹è¯•è¿æ¥</button>
            <button class="btn btn-info" onclick="testWebSocketSend()">æµ‹è¯•å‘é€æ¶ˆæ¯</button>
            <button class="btn btn-warning" onclick="testWebSocketDisconnect()">æ–­å¼€è¿æ¥</button>
        </div>
        <div id="websocket-status-display" class="status info">
            è¿æ¥çŠ¶æ€: æœªè¿æ¥
        </div>
        <div id="websocket-output" class="test-output"></div>
    </div>

    <!-- æ¶ˆæ¯ç®¡ç†å™¨æµ‹è¯• -->
    <div class="test-section">
        <h3>ğŸ’¬ UnifiedMessageManager æ¶ˆæ¯æµ‹è¯•</h3>
        <div class="test-controls">
            <button class="btn btn-primary" onclick="testAddMessage()">æ·»åŠ æ–‡æœ¬æ¶ˆæ¯</button>
            <button class="btn btn-primary" onclick="testAddImageMessage()">æ·»åŠ å›¾ç‰‡æ¶ˆæ¯</button>
            <button class="btn btn-primary" onclick="testMarkAsRead()">æ ‡è®°å·²è¯»</button>
            <button class="btn btn-warning" onclick="clearMessages()">æ¸…ç©ºæ¶ˆæ¯</button>
        </div>
        <div class="demo-area">
            <h4>æ¶ˆæ¯æ¼”ç¤ºåŒºåŸŸ:</h4>
            <div id="test-messages"></div>
        </div>
        <div id="message-output" class="test-output"></div>
    </div>

    <!-- æ€§èƒ½æµ‹è¯• -->
    <div class="test-section">
        <h3>âš¡ æ€§èƒ½æµ‹è¯•</h3>
        <div class="test-controls">
            <button class="btn btn-info" onclick="testPerformance()">è¿è¡Œæ€§èƒ½æµ‹è¯•</button>
            <button class="btn btn-primary" onclick="runFullTestSuite()">è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶</button>
        </div>
        <div id="performance-output" class="test-output"></div>
    </div>

    <!-- å¼•å…¥ç»Ÿä¸€ç»„ä»¶åº“ -->
    <script src="/static/js/core/UnifiedUtils.js"></script>
    <script src="/static/js/core/UnifiedWebSocketClient.js"></script>
    <script src="/static/js/core/UnifiedMessageManager.js"></script>
    
    <!-- æµ‹è¯•è„šæœ¬ -->
    <script src="/test-optimization-validation.js"></script>
    
    <script>
        // å…¨å±€å˜é‡
        let testWebSocketClient = null;
        let testMessageManager = null;
        let messageCounter = 0;

        // é¡µé¢åŠ è½½å®Œæˆåæ£€æŸ¥ç»„ä»¶çŠ¶æ€
        document.addEventListener('DOMContentLoaded', function() {
            checkComponentStatus();
            initializeTestComponents();
        });

        // æ£€æŸ¥ç»„ä»¶åŠ è½½çŠ¶æ€
        function checkComponentStatus() {
            const components = [
                { id: 'utils-status', name: 'UnifiedUtils', check: () => typeof UnifiedUtils !== 'undefined' },
                { id: 'websocket-status', name: 'UnifiedWebSocketClient', check: () => typeof UnifiedWebSocketClient !== 'undefined' },
                { id: 'message-status', name: 'UnifiedMessageManager', check: () => typeof UnifiedMessageManager !== 'undefined' }
            ];

            components.forEach(component => {
                const element = document.getElementById(component.id);
                const isLoaded = component.check();
                
                if (isLoaded) {
                    element.className = 'component-card loaded';
                    element.innerHTML = `<h4>${component.name}</h4><p>âœ… å·²åŠ è½½</p>`;
                } else {
                    element.className = 'component-card error';
                    element.innerHTML = `<h4>${component.name}</h4><p>âŒ åŠ è½½å¤±è´¥</p>`;
                }
            });
        }

        // åˆå§‹åŒ–æµ‹è¯•ç»„ä»¶
        function initializeTestComponents() {
            try {
                testMessageManager = new UnifiedMessageManager({
                    containerId: 'test-messages',
                    onNewMessage: (message) => {
                        logToOutput('message-output', `æ–°æ¶ˆæ¯å›è°ƒ: ${JSON.stringify(message)}`);
                    }
                });
                logToOutput('message-output', 'âœ… UnifiedMessageManager åˆå§‹åŒ–æˆåŠŸ');
            } catch (error) {
                logToOutput('message-output', `âŒ UnifiedMessageManager åˆå§‹åŒ–å¤±è´¥: ${error.message}`);
            }
        }

        // è¾“å‡ºæ—¥å¿—åˆ°æŒ‡å®šåŒºåŸŸ
        function logToOutput(outputId, message) {
            const output = document.getElementById(outputId);
            const timestamp = new Date().toLocaleTimeString();
            output.textContent += `[${timestamp}] ${message}\n`;
            output.scrollTop = output.scrollHeight;
        }

        // å·¥å…·å‡½æ•°æµ‹è¯•
        function testDeepClone() {
            try {
                const original = { a: 1, b: { c: 2 }, d: [1, 2, 3] };
                const cloned = UnifiedUtils.deepClone(original);
                
                const success = JSON.stringify(cloned) === JSON.stringify(original) && cloned !== original;
                logToOutput('utils-output', `æ·±æ‹·è´æµ‹è¯•: ${success ? 'âœ… é€šè¿‡' : 'âŒ å¤±è´¥'}`);
                logToOutput('utils-output', `åŸå¯¹è±¡: ${JSON.stringify(original)}`);
                logToOutput('utils-output', `æ‹·è´å¯¹è±¡: ${JSON.stringify(cloned)}`);
            } catch (error) {
                logToOutput('utils-output', `âŒ æ·±æ‹·è´æµ‹è¯•å¼‚å¸¸: ${error.message}`);
            }
        }

        function testDebounce() {
            try {
                let counter = 0;
                const debouncedFn = UnifiedUtils.debounce(() => counter++, 500);
                
                logToOutput('utils-output', 'å¼€å§‹é˜²æŠ–æµ‹è¯•ï¼Œå¿«é€Ÿè°ƒç”¨5æ¬¡...');
                for (let i = 0; i < 5; i++) {
                    debouncedFn();
                }
                
                setTimeout(() => {
                    logToOutput('utils-output', `é˜²æŠ–æµ‹è¯•ç»“æœ: è®¡æ•°å™¨å€¼ = ${counter} ${counter === 1 ? 'âœ… é€šè¿‡' : 'âŒ å¤±è´¥'}`);
                }, 1000);
            } catch (error) {
                logToOutput('utils-output', `âŒ é˜²æŠ–æµ‹è¯•å¼‚å¸¸: ${error.message}`);
            }
        }

        function testFormatTime() {
            try {
                const testDate = new Date('2024-12-01T12:30:45');
                const formatted = UnifiedUtils.formatTime(testDate, 'YYYY-MM-DD HH:mm:ss');
                const expected = '2024-12-01 12:30:45';
                
                logToOutput('utils-output', `æ—¶é—´æ ¼å¼åŒ–æµ‹è¯•: ${formatted === expected ? 'âœ… é€šè¿‡' : 'âŒ å¤±è´¥'}`);
                logToOutput('utils-output', `é¢„æœŸ: ${expected}, å®é™…: ${formatted}`);
            } catch (error) {
                logToOutput('utils-output', `âŒ æ—¶é—´æ ¼å¼åŒ–æµ‹è¯•å¼‚å¸¸: ${error.message}`);
            }
        }

        function testFileSize() {
            try {
                const tests = [
                    { input: 1024, expected: '1 KB' },
                    { input: 1048576, expected: '1 MB' },
                    { input: 1073741824, expected: '1 GB' }
                ];
                
                tests.forEach(test => {
                    const result = UnifiedUtils.formatFileSize(test.input);
                    const success = result === test.expected;
                    logToOutput('utils-output', `æ–‡ä»¶å¤§å°æ ¼å¼åŒ– ${test.input}: ${result} ${success ? 'âœ…' : 'âŒ'}`);
                });
            } catch (error) {
                logToOutput('utils-output', `âŒ æ–‡ä»¶å¤§å°æ ¼å¼åŒ–æµ‹è¯•å¼‚å¸¸: ${error.message}`);
            }
        }

        function testValidation() {
            try {
                const emailTests = [
                    { input: 'test@example.com', expected: true },
                    { input: 'invalid-email', expected: false }
                ];
                
                const urlTests = [
                    { input: 'https://example.com', expected: true },
                    { input: 'invalid-url', expected: false }
                ];
                
                emailTests.forEach(test => {
                    const result = UnifiedUtils.isValidEmail(test.input);
                    logToOutput('utils-output', `é‚®ç®±éªŒè¯ "${test.input}": ${result} ${result === test.expected ? 'âœ…' : 'âŒ'}`);
                });
                
                urlTests.forEach(test => {
                    const result = UnifiedUtils.isValidUrl(test.input);
                    logToOutput('utils-output', `URLéªŒè¯ "${test.input}": ${result} ${result === test.expected ? 'âœ…' : 'âŒ'}`);
                });
            } catch (error) {
                logToOutput('utils-output', `âŒ éªŒè¯å‡½æ•°æµ‹è¯•å¼‚å¸¸: ${error.message}`);
            }
        }

        // WebSocketæµ‹è¯•
        function testWebSocketConnection() {
            try {
                if (testWebSocketClient && testWebSocketClient.isConnected()) {
                    logToOutput('websocket-output', 'è¿æ¥å·²å­˜åœ¨ï¼Œå…ˆæ–­å¼€...');
                    testWebSocketClient.disconnect();
                }

                testWebSocketClient = new UnifiedWebSocketClient({
                    url: `${window.location.protocol === 'https:' ? 'wss:' : 'ws:'}//${window.location.host}/ws`,
                    onConnect: () => {
                        logToOutput('websocket-output', 'âœ… WebSocketè¿æ¥å·²å»ºç«‹');
                        updateWebSocketStatus('å·²è¿æ¥', 'success');
                    },
                    onMessage: (data) => {
                        logToOutput('websocket-output', `ğŸ“¨ æ”¶åˆ°æ¶ˆæ¯: ${JSON.stringify(data)}`);
                    },
                    onDisconnect: () => {
                        logToOutput('websocket-output', 'ğŸ”Œ WebSocketè¿æ¥å·²æ–­å¼€');
                        updateWebSocketStatus('å·²æ–­å¼€', 'error');
                    },
                    onError: (error) => {
                        logToOutput('websocket-output', `âŒ WebSocketé”™è¯¯: ${error}`);
                        updateWebSocketStatus('è¿æ¥é”™è¯¯', 'error');
                    },
                    autoReconnect: false
                });

                testWebSocketClient.connect();
                updateWebSocketStatus('è¿æ¥ä¸­...', 'info');
                logToOutput('websocket-output', 'å¼€å§‹WebSocketè¿æ¥æµ‹è¯•...');
            } catch (error) {
                logToOutput('websocket-output', `âŒ WebSocketè¿æ¥æµ‹è¯•å¼‚å¸¸: ${error.message}`);
                updateWebSocketStatus('è¿æ¥å¤±è´¥', 'error');
            }
        }

        function testWebSocketSend() {
            if (!testWebSocketClient || !testWebSocketClient.isConnected()) {
                logToOutput('websocket-output', 'âŒ WebSocketæœªè¿æ¥ï¼Œè¯·å…ˆå»ºç«‹è¿æ¥');
                return;
            }

            try {
                const testMessage = {
                    type: 'test',
                    content: `æµ‹è¯•æ¶ˆæ¯ #${++messageCounter}`,
                    timestamp: Date.now()
                };

                testWebSocketClient.send(testMessage);
                logToOutput('websocket-output', `ğŸ“¤ å‘é€æµ‹è¯•æ¶ˆæ¯: ${JSON.stringify(testMessage)}`);
            } catch (error) {
                logToOutput('websocket-output', `âŒ å‘é€æ¶ˆæ¯å¤±è´¥: ${error.message}`);
            }
        }

        function testWebSocketDisconnect() {
            if (testWebSocketClient) {
                testWebSocketClient.disconnect();
                logToOutput('websocket-output', 'æ–­å¼€WebSocketè¿æ¥');
            } else {
                logToOutput('websocket-output', 'æ²¡æœ‰æ´»åŠ¨çš„WebSocketè¿æ¥');
            }
        }

        function updateWebSocketStatus(status, type) {
            const statusElement = document.getElementById('websocket-status-display');
            statusElement.textContent = `è¿æ¥çŠ¶æ€: ${status}`;
            statusElement.className = `status ${type}`;
        }

        // æ¶ˆæ¯ç®¡ç†å™¨æµ‹è¯•
        function testAddMessage() {
            if (!testMessageManager) {
                logToOutput('message-output', 'âŒ UnifiedMessageManager æœªåˆå§‹åŒ–');
                return;
            }

            const message = {
                id: `test-msg-${++messageCounter}`,
                content: `è¿™æ˜¯æµ‹è¯•æ¶ˆæ¯ #${messageCounter}`,
                sender_type: messageCounter % 2 === 0 ? 'customer' : 'staff',
                created_at: new Date().toISOString()
            };

            testMessageManager.addMessage(message);
            logToOutput('message-output', `âœ… æ·»åŠ æ¶ˆæ¯: ${JSON.stringify(message)}`);
        }

        function testAddImageMessage() {
            if (!testMessageManager) {
                logToOutput('message-output', 'âŒ UnifiedMessageManager æœªåˆå§‹åŒ–');
                return;
            }

            const imageMessage = {
                id: `test-img-${++messageCounter}`,
                content: 'å›¾ç‰‡æ¶ˆæ¯',
                sender_type: 'staff',
                file_url: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iIzY2N2VlYSIvPgogIDx0ZXh0IHg9IjUwIiB5PSI1NSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0IiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSI+VEVTVDwvdGV4dD4KPC9zdmc+',
                file_name: 'test-image.svg',
                created_at: new Date().toISOString()
            };

            testMessageManager.addImageMessage(imageMessage);
            logToOutput('message-output', `âœ… æ·»åŠ å›¾ç‰‡æ¶ˆæ¯: ${imageMessage.file_name}`);
        }

        function testMarkAsRead() {
            if (!testMessageManager) {
                logToOutput('message-output', 'âŒ UnifiedMessageManager æœªåˆå§‹åŒ–');
                return;
            }

            const messageElements = document.querySelectorAll('#test-messages .message');
            const messageIds = Array.from(messageElements).map(el => el.dataset.messageId).filter(id => id);

            if (messageIds.length > 0) {
                testMessageManager.markMessagesAsRead(messageIds);
                logToOutput('message-output', `âœ… æ ‡è®° ${messageIds.length} æ¡æ¶ˆæ¯ä¸ºå·²è¯»`);
            } else {
                logToOutput('message-output', 'âŒ æ²¡æœ‰æ¶ˆæ¯å¯æ ‡è®°ä¸ºå·²è¯»');
            }
        }

        function clearMessages() {
            const container = document.getElementById('test-messages');
            container.innerHTML = '';
            logToOutput('message-output', 'ğŸ—‘ï¸ æ¸…ç©ºæ‰€æœ‰æµ‹è¯•æ¶ˆæ¯');
        }

        // æ€§èƒ½æµ‹è¯•
        function testPerformance() {
            logToOutput('performance-output', 'ğŸš€ å¼€å§‹æ€§èƒ½æµ‹è¯•...');

            // æ·±æ‹·è´æ€§èƒ½æµ‹è¯•
            const largeObject = {
                data: new Array(1000).fill(0).map((_, i) => ({ id: i, value: `item_${i}`, nested: { prop: i * 2 } }))
            };

            const startTime = performance.now();
            const cloned = UnifiedUtils.deepClone(largeObject);
            const endTime = performance.now();
            const cloneTime = endTime - startTime;

            logToOutput('performance-output', `æ·±æ‹·è´æ€§èƒ½: ${cloneTime.toFixed(2)}ms (1000ä¸ªå¯¹è±¡)`);
            logToOutput('performance-output', `æ‹·è´æ­£ç¡®æ€§: ${cloned.data.length === 1000 ? 'âœ… é€šè¿‡' : 'âŒ å¤±è´¥'}`);

            // é˜²æŠ–æ€§èƒ½æµ‹è¯•
            let counter = 0;
            const perfStartTime = performance.now();
            const debouncedFn = UnifiedUtils.debounce(() => counter++, 10);

            for (let i = 0; i < 100; i++) {
                debouncedFn();
            }

            const perfEndTime = performance.now();
            const debounceTime = perfEndTime - perfStartTime;

            logToOutput('performance-output', `é˜²æŠ–åˆ›å»ºæ€§èƒ½: ${debounceTime.toFixed(2)}ms (100æ¬¡è°ƒç”¨)`);

            // æ¶ˆæ¯æ¸²æŸ“æ€§èƒ½æµ‹è¯•
            if (testMessageManager) {
                const renderStartTime = performance.now();
                
                for (let i = 0; i < 50; i++) {
                    testMessageManager.addMessage({
                        id: `perf-test-${i}`,
                        content: `æ€§èƒ½æµ‹è¯•æ¶ˆæ¯ ${i}`,
                        sender_type: i % 2 === 0 ? 'customer' : 'staff',
                        created_at: new Date().toISOString()
                    });
                }
                
                const renderEndTime = performance.now();
                const renderTime = renderEndTime - renderStartTime;
                
                logToOutput('performance-output', `æ¶ˆæ¯æ¸²æŸ“æ€§èƒ½: ${renderTime.toFixed(2)}ms (50æ¡æ¶ˆæ¯)`);
                
                // æ¸…ç†æ€§èƒ½æµ‹è¯•æ¶ˆæ¯
                setTimeout(() => {
                    clearMessages();
                    logToOutput('performance-output', 'ğŸ§¹ æ¸…ç†æ€§èƒ½æµ‹è¯•æ¶ˆæ¯');
                }, 2000);
            }
        }

        // è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
        function runFullTestSuite() {
            if (typeof runAllTests === 'function') {
                logToOutput('performance-output', 'ğŸ§ª å¯åŠ¨å®Œæ•´æµ‹è¯•å¥—ä»¶...');
                runAllTests().then(report => {
                    logToOutput('performance-output', `ğŸ“Š æµ‹è¯•å®Œæˆ: é€šè¿‡ ${report.passed}, å¤±è´¥ ${report.failed}`);
                    logToOutput('performance-output', `ğŸ“ˆ æˆåŠŸç‡: ${report.successRate}%`);
                });
            } else {
                logToOutput('performance-output', 'âŒ å®Œæ•´æµ‹è¯•å¥—ä»¶æœªåŠ è½½');
            }
        }
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®€åŒ–æ–‡ä»¶ä¸Šä¼ æµ‹è¯• - QuickTalk v1.3.1</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            padding: 30px;
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
            font-size: 28px;
        }

        .improvement-box {
            background: #e8f5e8;
            border: 1px solid #4caf50;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
        }

        .improvement-box h3 {
            color: #2e7d32;
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .before, .after {
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #ddd;
        }

        .before {
            background: #fff3e0;
            border-color: #ff9800;
        }

        .after {
            background: #e8f5e8;
            border-color: #4caf50;
        }

        .before h4, .after h4 {
            margin-top: 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .before h4 {
            color: #f57c00;
        }

        .after h4 {
            color: #2e7d32;
        }

        .feature-list {
            list-style: none;
            padding: 0;
            margin: 10px 0;
        }

        .feature-list li {
            padding: 5px 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .feature-list .problem::before {
            content: 'âŒ';
        }

        .feature-list .fixed::before {
            content: 'âœ…';
        }

        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background: #f9f9f9;
        }

        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
            transition: all 0.3s ease;
        }

        button:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }

        .demo-area {
            min-height: 300px;
            border: 2px dashed #ddd;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #fafafa;
            margin-top: 20px;
            text-align: center;
        }

        @media (max-width: 768px) {
            .comparison {
                grid-template-columns: 1fr;
            }
            
            .container {
                margin: 10px;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¯ QuickTalk v1.3.1 - ç®€åŒ–æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½</h1>
        
        <div class="improvement-box">
            <h3>ğŸ‰ ç”¨æˆ·ä½“éªŒä¼˜åŒ–å®Œæˆ</h3>
            <p><strong>ä¸»è¦æ”¹è¿›ï¼š</strong>ä¸“æ³¨äºå•æ–‡ä»¶ä¸Šä¼ ï¼Œä¼˜åŒ–ç§»åŠ¨ç«¯ä½“éªŒï¼Œç®€åŒ–æ“ä½œæµç¨‹</p>
            <p><strong>è®¾è®¡ç†å¿µï¼š</strong>ä¸€æ¬¡å‘é€ä¸€ä¸ªæ–‡ä»¶å°±è¶³å¤Ÿäº†ï¼Œç®€å•æ˜“ç”¨æ¯”åŠŸèƒ½å¤æ‚æ›´é‡è¦</p>
        </div>

        <div class="comparison">
            <div class="before">
                <h4>ğŸ”§ æ”¹è¿›å‰é—®é¢˜</h4>
                <ul class="feature-list">
                    <li class="problem">æ”¯æŒå¤šæ–‡ä»¶ä¸Šä¼ ï¼ˆå®é™…ä¸éœ€è¦ï¼‰</li>
                    <li class="problem">æ¨¡æ€æ¡†è¿‡å¤§ï¼ŒæŒ‰é’®è¢«é®æŒ¡</li>
                    <li class="problem">æ— æ»šåŠ¨æ¡ï¼Œç§»åŠ¨ç«¯ä½“éªŒå·®</li>
                    <li class="problem">æ‹–æ‹½åŠŸèƒ½å¢åŠ å¤æ‚æ€§</li>
                    <li class="problem">è¿›åº¦æ˜¾ç¤ºå ç”¨ç©ºé—´</li>
                    <li class="problem">ç•Œé¢å…ƒç´ è¿‡å¤š</li>
                </ul>
            </div>
            
            <div class="after">
                <h4>âœ… æ”¹è¿›åä¼˜åŠ¿</h4>
                <ul class="feature-list">
                    <li class="fixed">ä¸“æ³¨å•æ–‡ä»¶ä¸Šä¼ </li>
                    <li class="fixed">ç´§å‡‘å‹æ¨¡æ€æ¡†è®¾è®¡</li>
                    <li class="fixed">ç§»åŠ¨ç«¯å‹å¥½å°ºå¯¸</li>
                    <li class="fixed">ç®€åŒ–ä¸ºç‚¹å‡»é€‰æ‹©</li>
                    <li class="fixed">æŒ‰é’®çŠ¶æ€ç›´æ¥åé¦ˆ</li>
                    <li class="fixed">æ¸…çˆ½ç®€æ´ç•Œé¢</li>
                </ul>
            </div>
        </div>

        <div class="test-section">
            <h3>ğŸ¨ UIæ”¹è¿›è¯¦æƒ…</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px; margin-top: 15px;">
                <div style="background: white; padding: 15px; border-radius: 6px; border: 1px solid #e0e0e0;">
                    <h4 style="margin-top: 0; color: #555;">ğŸ“± ç§»åŠ¨ç«¯ä¼˜åŒ–</h4>
                    <p>â€¢ æ¨¡æ€æ¡†å®½åº¦95%ï¼Œç¡®ä¿å®Œæ•´æ˜¾ç¤º<br>
                    â€¢ å‡å°‘å†…è¾¹è·ï¼ŒèŠ‚çœç©ºé—´<br>
                    â€¢ æ–‡ä»¶é€‰æ‹©åŒºåŸŸé€‚é…å°å±å¹•</p>
                </div>
                <div style="background: white; padding: 15px; border-radius: 6px; border: 1px solid #e0e0e0;">
                    <h4 style="margin-top: 0; color: #555;">ğŸ¯ äº¤äº’ç®€åŒ–</h4>
                    <p>â€¢ ç§»é™¤æ‹–æ‹½åŠŸèƒ½<br>
                    â€¢ ç‚¹å‡»å³å¯é€‰æ‹©æ–‡ä»¶<br>
                    â€¢ å‘é€æŒ‰é’®æ˜¾ç¤ºä¸Šä¼ çŠ¶æ€</p>
                </div>
                <div style="background: white; padding: 15px; border-radius: 6px; border: 1px solid #e0e0e0;">
                    <h4 style="margin-top: 0; color: #555;">ğŸ—ï¸ ç»“æ„ç²¾ç®€</h4>
                    <p>â€¢ ç§»é™¤è¿›åº¦æ¡ç»„ä»¶<br>
                    â€¢ ç®€åŒ–é¢„è§ˆæ ·å¼<br>
                    â€¢ å‡å°‘CSSè§„åˆ™</p>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h3>ğŸ§ª åŠŸèƒ½æµ‹è¯•</h3>
            <p>æµ‹è¯•ç®€åŒ–åçš„æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼ŒéªŒè¯ç”¨æˆ·ä½“éªŒæ”¹è¿›ï¼š</p>
            
            <button onclick="testServerConnection()">æµ‹è¯•æœåŠ¡å™¨è¿æ¥</button>
            <button onclick="testModalSize()">æµ‹è¯•æ¨¡æ€æ¡†å°ºå¯¸</button>
            <button onclick="openMobileDemo()">ç§»åŠ¨ç«¯æ¼”ç¤º</button>
            <button onclick="openClientTest()">å®¢æˆ·ç«¯æµ‹è¯•</button>

            <div class="demo-area" id="demo-area">
                <div>
                    <p>ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹æµ‹è¯•</p>
                    <p>æˆ–è€…ç­‰å¾…å®¢æœç³»ç»ŸåŠ¨æ€åŠ è½½...</p>
                    <small>æ³¨æ„è§‚å¯Ÿæ–‡ä»¶ä¸Šä¼ ç•Œé¢çš„ç®€æ´æ€§</small>
                </div>
            </div>

            <div id="test-results" style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 6px; display: none;">
                <h4>æµ‹è¯•ç»“æœ</h4>
                <div id="test-log"></div>
            </div>
        </div>

        <div class="test-section">
            <h3>ğŸ“Š æ”¹è¿›æ•ˆæœå¯¹æ¯”</h3>
            <table style="width: 100%; border-collapse: collapse; margin-top: 15px;">
                <thead>
                    <tr style="background: #f8f9fa;">
                        <th style="border: 1px solid #ddd; padding: 12px; text-align: left;">æŒ‡æ ‡</th>
                        <th style="border: 1px solid #ddd; padding: 12px; text-align: center;">v1.3.0</th>
                        <th style="border: 1px solid #ddd; padding: 12px; text-align: center;">v1.3.1</th>
                        <th style="border: 1px solid #ddd; padding: 12px; text-align: center;">æ”¹è¿›</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 12px;">æ¨¡æ€æ¡†æœ€å¤§å®½åº¦</td>
                        <td style="border: 1px solid #ddd; padding: 12px; text-align: center;">500px</td>
                        <td style="border: 1px solid #ddd; padding: 12px; text-align: center;">400px</td>
                        <td style="border: 1px solid #ddd; padding: 12px; text-align: center;">âœ… æ›´ç´§å‡‘</td>
                    </tr>
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 12px;">ç§»åŠ¨ç«¯å®½åº¦</td>
                        <td style="border: 1px solid #ddd; padding: 12px; text-align: center;">90%</td>
                        <td style="border: 1px solid #ddd; padding: 12px; text-align: center;">95%</td>
                        <td style="border: 1px solid #ddd; padding: 12px; text-align: center;">âœ… æ›´å¥½é€‚é…</td>
                    </tr>
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 12px;">åŠŸèƒ½å¤æ‚åº¦</td>
                        <td style="border: 1px solid #ddd; padding: 12px; text-align: center;">é«˜ï¼ˆæ‹–æ‹½+å¤šæ–‡ä»¶ï¼‰</td>
                        <td style="border: 1px solid #ddd; padding: 12px; text-align: center;">ç®€å•ï¼ˆç‚¹å‡»é€‰æ‹©ï¼‰</td>
                        <td style="border: 1px solid #ddd; padding: 12px; text-align: center;">âœ… æ›´ç®€æ´</td>
                    </tr>
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 12px;">æ“ä½œæ­¥éª¤</td>
                        <td style="border: 1px solid #ddd; padding: 12px; text-align: center;">4-5æ­¥</td>
                        <td style="border: 1px solid #ddd; padding: 12px; text-align: center;">3æ­¥</td>
                        <td style="border: 1px solid #ddd; padding: 12px; text-align: center;">âœ… æ›´é«˜æ•ˆ</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <script>
        const TEST_CONFIG = {
            serverUrl: 'http://localhost:3030',
            version: '1.3.1'
        };

        function showTestResult(message, type = 'info') {
            const results = document.getElementById('test-results');
            const log = document.getElementById('test-log');
            
            results.style.display = 'block';
            const timestamp = new Date().toLocaleTimeString();
            const icon = type === 'success' ? 'âœ…' : type === 'error' ? 'âŒ' : 'â„¹ï¸';
            
            log.innerHTML += `<div style="margin: 5px 0;">[${timestamp}] ${icon} ${message}</div>`;
            log.scrollTop = log.scrollHeight;
        }

        async function testServerConnection() {
            showTestResult('å¼€å§‹æµ‹è¯•æœåŠ¡å™¨è¿æ¥...', 'info');
            
            try {
                const response = await fetch(TEST_CONFIG.serverUrl + '/embed/version');
                const data = await response.json();
                
                showTestResult(`æœåŠ¡å™¨è¿æ¥æˆåŠŸï¼ç‰ˆæœ¬: ${data.version}`, 'success');
                
                // æ£€æŸ¥æ˜¯å¦ä¸ºç®€åŒ–ç‰ˆæœ¬
                if (data.version.includes('1.3.1')) {
                    showTestResult('ç‰ˆæœ¬æ£€æŸ¥ï¼šå·²æ˜¯ç®€åŒ–ç‰ˆæœ¬ v1.3.1', 'success');
                } else {
                    showTestResult('ç‰ˆæœ¬æ£€æŸ¥ï¼šéœ€è¦é‡å¯æœåŠ¡å™¨ä»¥åŠ è½½ v1.3.1', 'info');
                }
                
            } catch (error) {
                showTestResult(`æœåŠ¡å™¨è¿æ¥å¤±è´¥: ${error.message}`, 'error');
                showTestResult('è¯·ç¡®ä¿æœåŠ¡å™¨å·²å¯åŠ¨: npm run dev', 'info');
            }
        }

        async function testModalSize() {
            showTestResult('å¼€å§‹æµ‹è¯•æ¨¡æ€æ¡†å°ºå¯¸ä¼˜åŒ–...', 'info');
            
            try {
                const cssResponse = await fetch(TEST_CONFIG.serverUrl + '/embed/customer-service.css?v=' + Date.now());
                const cssText = await cssResponse.text();
                
                // æ£€æŸ¥CSSä¸­çš„æ¨¡æ€æ¡†å°ºå¯¸
                if (cssText.includes('max-width:400px')) {
                    showTestResult('âœ… æ¨¡æ€æ¡†å®½åº¦å·²ä¼˜åŒ–ä¸º400pxï¼ˆç§»åŠ¨ç«¯å‹å¥½ï¼‰', 'success');
                } else {
                    showTestResult('âš ï¸ æ¨¡æ€æ¡†å®½åº¦å¯èƒ½æœªæ›´æ–°', 'info');
                }
                
                if (cssText.includes('width:95%')) {
                    showTestResult('âœ… ç§»åŠ¨ç«¯å®½åº¦å·²ä¼˜åŒ–ä¸º95%', 'success');
                } else {
                    showTestResult('âš ï¸ ç§»åŠ¨ç«¯å®½åº¦å¯èƒ½æœªæ›´æ–°', 'info');
                }
                
                // æ£€æŸ¥æ˜¯å¦ç§»é™¤äº†å¤æ‚åŠŸèƒ½
                if (!cssText.includes('drop-zone') && !cssText.includes('upload-progress')) {
                    showTestResult('âœ… å·²ç§»é™¤æ‹–æ‹½å’Œè¿›åº¦æ¡ç›¸å…³æ ·å¼', 'success');
                } else {
                    showTestResult('âš ï¸ å¯èƒ½ä»åŒ…å«å¤æ‚åŠŸèƒ½çš„æ ·å¼', 'info');
                }
                
            } catch (error) {
                showTestResult(`æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        function openMobileDemo() {
            const demoArea = document.getElementById('demo-area');
            demoArea.innerHTML = '<div style="max-width: 400px; margin: 0 auto;"><p>ğŸ“± ç§»åŠ¨ç«¯è§†å›¾æ¼”ç¤º</p><p>æ¨¡æ‹Ÿç§»åŠ¨è®¾å¤‡å®½åº¦æ˜¾ç¤ºæ•ˆæœ</p><button onclick="loadCustomerService()" style="width: 100%; margin-top: 10px;">åŠ è½½å®¢æœç³»ç»Ÿ</button></div>';
            
            showTestResult('åˆ‡æ¢åˆ°ç§»åŠ¨ç«¯è§†å›¾æ¼”ç¤º', 'info');
        }

        function openClientTest() {
            window.open('https://bbs16.929991.xyz/xinaomen/', '_blank');
            showTestResult('æ‰“å¼€å®¢æˆ·ç«¯æµ‹è¯•é¡µé¢', 'info');
        }

        function loadCustomerService() {
            const QUICKTALK_CONFIG = {
                shopKey: 'sk_ji85ucic9p00m12as1ygf34o8humuxfl',
                shopId: 'shop_1757591780450_1',
                shopName: 'æµ‹è¯•åº—é“º',
                authorizedDomain: 'localhost',
                serverUrl: 'http://localhost:3030',
                version: '1.3.1',
                cacheBreaker: Date.now()
            };
            
            // åŠ¨æ€åŠ è½½CSS
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = QUICKTALK_CONFIG.serverUrl + '/embed/customer-service.css?v=' + QUICKTALK_CONFIG.cacheBreaker;
            document.head.appendChild(link);
            
            // åŠ¨æ€åŠ è½½JS
            const script = document.createElement('script');
            script.src = QUICKTALK_CONFIG.serverUrl + '/embed/customer-service.js?v=' + QUICKTALK_CONFIG.cacheBreaker;
            script.onload = () => {
                if (window.QuickTalkCustomerService) {
                    window.QuickTalkCustomerService.init(QUICKTALK_CONFIG);
                    showTestResult('âœ… å®¢æœç³»ç»ŸåŠ è½½æˆåŠŸï¼è¯·æŸ¥çœ‹å³ä¸‹è§’å®¢æœæŒ‰é’®', 'success');
                    showTestResult('ğŸ’¡ ç‚¹å‡»ğŸ“æŒ‰é’®æµ‹è¯•ç®€åŒ–çš„æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½', 'info');
                } else {
                    showTestResult('âŒ å®¢æœç³»ç»ŸåŠ è½½å¤±è´¥', 'error');
                }
            };
            script.onerror = () => {
                showTestResult('âŒ è„šæœ¬åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥æœåŠ¡å™¨çŠ¶æ€', 'error');
            };
            document.head.appendChild(script);
            
            window.QUICKTALK_EMBED_CONFIG = QUICKTALK_CONFIG;
        }

        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨æµ‹è¯•
        window.addEventListener('load', () => {
            setTimeout(testServerConnection, 1000);
        });
    </script>
</body>
</html>
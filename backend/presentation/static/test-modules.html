<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¨¡å—åŠ è½½æµ‹è¯•</title>
</head>
<body>
    <h1>æ¨¡å—åŠ è½½æµ‹è¯•é¡µé¢</h1>
    <div id="test-results"></div>

    <!-- æŒ‰æ­£ç¡®é¡ºåºåŠ è½½æ¨¡å— -->
    <script src="/static/js/core/module-registry.js"></script>     <!-- æ¨¡å—æ³¨å†Œä¸­å¿ƒ -->
    <script src="/static/js/core/unified-logger.js"></script>      <!-- ç»Ÿä¸€æ—¥å¿—ç®¡ç†å™¨ -->
    <script src="/static/js/core/unified-event-bus.js"></script>   <!-- ç»Ÿä¸€äº‹ä»¶æ€»çº¿ -->
    <script src="/static/js/core/event-migration-compat.js"></script> <!-- äº‹ä»¶ç³»ç»Ÿå…¼å®¹å±‚ -->

    <script>
        // æµ‹è¯•è„šæœ¬
        (function() {
            'use strict';
            
            const results = document.getElementById('test-results');
            const tests = [];
            
            function addTest(name, test) {
                try {
                    const result = test();
                    tests.push(`âœ… ${name}: ${result || 'PASS'}`);
                } catch (error) {
                    tests.push(`âŒ ${name}: ${error.message}`);
                    console.error(`Test failed: ${name}`, error);
                }
            }
            
            // ç­‰å¾…æ‰€æœ‰æ¨¡å—åŠ è½½
            setTimeout(() => {
                console.log('ğŸ§ª å¼€å§‹æ¨¡å—æµ‹è¯•...');
                
                // æµ‹è¯•æ¨¡å—æ³¨å†Œä¸­å¿ƒ
                addTest('ModuleRegistryå­˜åœ¨', () => {
                    return window.ModuleRegistry ? 'OK' : 'MISSING';
                });
                
                addTest('getModuleå‡½æ•°å­˜åœ¨', () => {
                    return typeof window.getModule === 'function' ? 'OK' : 'MISSING';
                });
                
                addTest('registerModuleå‡½æ•°å­˜åœ¨', () => {
                    return typeof window.registerModule === 'function' ? 'OK' : 'MISSING';
                });
                
                // æµ‹è¯•ç»Ÿä¸€æ—¥å¿—å™¨
                addTest('UnifiedLoggerå­˜åœ¨', () => {
                    return window.UnifiedLogger ? 'OK' : 'MISSING';
                });
                
                addTest('Loggerså¯¹è±¡å­˜åœ¨', () => {
                    return window.Loggers ? 'OK' : 'MISSING';
                });
                
                // æµ‹è¯•ç»Ÿä¸€äº‹ä»¶æ€»çº¿
                addTest('UnifiedEventBuså­˜åœ¨', () => {
                    return window.UnifiedEventBus ? 'OK' : 'MISSING';
                });
                
                addTest('eventBuså…¨å±€å®ä¾‹å­˜åœ¨', () => {
                    return window.eventBus ? 'OK' : 'MISSING';
                });
                
                // æµ‹è¯•äº‹ä»¶å…¼å®¹å±‚
                addTest('EventBuså…¼å®¹ç±»å­˜åœ¨', () => {
                    return window.EventBus ? 'OK' : 'MISSING';
                });
                
                // æµ‹è¯•æ¨¡å—æ³¨å†Œ
                addTest('EventBusæ¨¡å—å·²æ³¨å†Œ', () => {
                    const eventBusModule = window.getModule('EventBus');
                    return eventBusModule ? 'OK' : 'NOT_REGISTERED';
                });
                
                // æ˜¾ç¤ºç»“æœ
                results.innerHTML = `
                    <h2>æµ‹è¯•ç»“æœ</h2>
                    <pre>${tests.join('\n')}</pre>
                    <h3>æ§åˆ¶å°æ—¥å¿—</h3>
                    <p>è¯·æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°è·å–è¯¦ç»†ä¿¡æ¯</p>
                `;
                
                console.log('ğŸ¯ æµ‹è¯•å®Œæˆ:', tests);
                
            }, 100);
            
        })();
    </script>
</body>
</html>
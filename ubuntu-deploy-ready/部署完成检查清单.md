# âœ… Ubuntu HTTPS éƒ¨ç½²å®Œæˆæ£€æŸ¥æ¸…å•

## ğŸ“¦ Windows ç«¯ - éƒ¨ç½²åŒ…å‡†å¤‡

### âœ… ç¼–è¯‘å®Œæˆç¡®è®¤
- [x] Rust åç«¯äº¤å‰ç¼–è¯‘æˆåŠŸ
- [x] äºŒè¿›åˆ¶æ–‡ä»¶: `customer-service-backend` (8.04 MB)
- [x] ç¼–è¯‘æ—¶é—´: 2025-10-15 23:04
- [x] ç›®æ ‡å¹³å°: x86_64-unknown-linux-musl
- [x] TLS æ”¯æŒ: Rustls (çº¯Rust, æ— OpenSSLä¾èµ–)
- [x] æ•°æ®åº“: Sea-ORM è‡ªåŠ¨è¿ç§»

### âœ… éƒ¨ç½²æ–‡ä»¶æ¸…å•
- [x] åç«¯äºŒè¿›åˆ¶: `customer-service-backend`
- [x] ç¯å¢ƒé…ç½®: `.env` (HTTPSå¼ºåˆ¶æ¨¡å¼)
- [x] SSLè¯ä¹¦: `certs/server.crt`, `certs/server.key`
- [x] å‰ç«¯æ–‡ä»¶: `static/` ç›®å½•
- [x] éƒ¨ç½²è„šæœ¬: `deploy.sh`
- [x] å¯åŠ¨è„šæœ¬: `start.sh`
- [x] æœåŠ¡é…ç½®: `customer-service.service`
- [x] æ–‡æ¡£èµ„æ–™: æ‰€æœ‰ .md æ–‡ä»¶

### âœ… ä¸Šä¼ å‡†å¤‡
**ç›®æ ‡è·¯å¾„**: `/root/ubuntu-deploy-ready/`

**ä¸Šä¼ å‘½ä»¤** (é€‰æ‹©ä¸€ç§):
```powershell
# æ–¹æ³•1: SCPç›´æ¥ä¸Šä¼ 
scp -r E:\duihua\customer-service-system\ubuntu-deploy-ready root@43.139.82.12:/root/

# æ–¹æ³•2: ä½¿ç”¨WinSCP/FileZillaç­‰SFTPå·¥å…·
```

---

## ğŸŒ Ubuntu æœåŠ¡å™¨ç«¯ - éƒ¨ç½²æ‰§è¡Œ

### 1ï¸âƒ£ è¿æ¥æœåŠ¡å™¨
```bash
ssh root@43.139.82.12
```

### 2ï¸âƒ£ éªŒè¯æ–‡ä»¶ä¸Šä¼ 
```bash
cd /root/ubuntu-deploy-ready
ls -lh customer-service-backend
# åº”æ˜¾ç¤º 8.0M å·¦å³çš„æ–‡ä»¶

# æ£€æŸ¥æ–‡ä»¶å®Œæ•´æ€§
ls -la
# åº”åŒ…å«: customer-service-backend, .env, certs/, static/, *.sh
```

### 3ï¸âƒ£ æ‰§è¡Œè‡ªåŠ¨éƒ¨ç½²
```bash
chmod +x deploy.sh
./deploy.sh
```

**éƒ¨ç½²è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆ**:
- âœ… ç³»ç»Ÿæ›´æ–°å’Œå·¥å…·å®‰è£…
- âœ… æ–‡ä»¶æƒé™è®¾ç½®
- âœ… æ•°æ®åº“åˆå§‹åŒ–
- âœ… é˜²ç«å¢™é…ç½® (22, 8080, 8443)
- âœ… systemd æœåŠ¡å®‰è£…
- âœ… æœåŠ¡å¯åŠ¨

### 4ï¸âƒ£ éªŒè¯æœåŠ¡çŠ¶æ€
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
systemctl status customer-service
# åº”æ˜¾ç¤º: Active: active (running)

# æŸ¥çœ‹å®æ—¶æ—¥å¿—
journalctl -u customer-service -f
# åº”çœ‹åˆ°: "Server running on..." ç­‰å¯åŠ¨ä¿¡æ¯
```

### 5ï¸âƒ£ éªŒè¯ç«¯å£ç›‘å¬
```bash
netstat -tulpn | grep -E '8080|8443'
# åº”æ˜¾ç¤º:
# tcp  0.0.0.0:8080  (HTTP)
# tcp  0.0.0.0:8443  (HTTPS)
```

### 6ï¸âƒ£ éªŒè¯é˜²ç«å¢™
```bash
ufw status verbose
# åº”æ˜¾ç¤º:
# 22/tcp   ALLOW IN    Anywhere
# 8080/tcp ALLOW IN    Anywhere
# 8443/tcp ALLOW IN    Anywhere
# Status: active
```

### 7ï¸âƒ£ éªŒè¯æ•°æ®åº“
```bash
ls -lh customer_service.db
# åº”æ˜¾ç¤ºæ•°æ®åº“æ–‡ä»¶ (å‡ åKB)

sqlite3 customer_service.db "SELECT name FROM sqlite_master WHERE type='table';"
# åº”æ˜¾ç¤ºæ‰€æœ‰è¡¨: users, shops, customers, sessions, messagesç­‰
```

---

## ğŸŒ æµè§ˆå™¨ç«¯ - è®¿é—®æµ‹è¯•

### âœ… HTTPS è®¿é—® (æ¨è)
- **åŸŸå**: https://elontalk.duckdns.org:8443
- **IP**: https://43.139.82.12:8443

**é¦–æ¬¡è®¿é—®æç¤º**:
- âš ï¸ æµè§ˆå™¨ä¼šæ˜¾ç¤º"ä¸å®‰å…¨"è­¦å‘Šï¼ˆè‡ªç­¾åè¯ä¹¦ï¼‰
- ç‚¹å‡»"é«˜çº§" -> "ç»§ç»­è®¿é—®"

### âœ… HTTP è®¿é—® (ä¼šè‡ªåŠ¨é‡å®šå‘)
- **åŸŸå**: http://elontalk.duckdns.org:8080
- **IP**: http://43.139.82.12:8080
- ä¼šè‡ªåŠ¨é‡å®šå‘åˆ° HTTPS

### âœ… åŠŸèƒ½æµ‹è¯•
1. è®¿é—®ç®¡ç†åå°é¦–é¡µ
2. æµ‹è¯•ç”¨æˆ·æ³¨å†Œ
3. æµ‹è¯•ç”¨æˆ·ç™»å½•
4. æ£€æŸ¥é™æ€èµ„æºåŠ è½½ (JS, CSS, å›¾ç‰‡)
5. æµ‹è¯• WebSocket è¿æ¥

---

## ğŸ” æ•…éšœæ’æŸ¥æ­¥éª¤

### é—®é¢˜1: æœåŠ¡æ— æ³•å¯åŠ¨
```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯æ—¥å¿—
journalctl -u customer-service -n 100 --no-pager

# æ£€æŸ¥äºŒè¿›åˆ¶æ–‡ä»¶æƒé™
ls -l customer-service-backend
chmod +x customer-service-backend

# æ‰‹åŠ¨æµ‹è¯•è¿è¡Œ
cd /root/ubuntu-deploy-ready
./customer-service-backend
```

### é—®é¢˜2: ç«¯å£è¢«å ç”¨
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tulpn | grep -E '8080|8443'

# å¦‚æœ‰å…¶ä»–è¿›ç¨‹å ç”¨ï¼Œkillæ‰
kill -9 <PID>

# é‡å¯æœåŠ¡
systemctl restart customer-service
```

### é—®é¢˜3: æ•°æ®åº“æƒé™é”™è¯¯
```bash
# ä¿®å¤æƒé™
chmod 755 /root/ubuntu-deploy-ready
chmod 644 customer_service.db

# å¦‚æœæ•°æ®åº“æŸåï¼Œåˆ é™¤é‡å»º
rm customer_service.db
systemctl restart customer-service
```

### é—®é¢˜4: é™æ€æ–‡ä»¶404
```bash
# æ£€æŸ¥staticç›®å½•æƒé™
ls -la static/
chmod -R 755 static/

# æ£€æŸ¥index.html
ls -l static/index.html
```

### é—®é¢˜5: é˜²ç«å¢™é˜»æ­¢è®¿é—®
```bash
# é‡æ–°é…ç½®é˜²ç«å¢™
ufw --force reset
ufw allow 22/tcp
ufw allow 8080/tcp
ufw allow 8443/tcp
ufw --force enable

# æ£€æŸ¥äº‘æœåŠ¡å•†å®‰å…¨ç»„è§„åˆ™
# ç¡®ä¿å¼€æ”¾ 22, 8080, 8443 ç«¯å£
```

### é—®é¢˜6: SSLè¯ä¹¦é”™è¯¯
```bash
# éªŒè¯è¯ä¹¦æ–‡ä»¶
openssl x509 -in certs/server.crt -text -noout

# æ£€æŸ¥æƒé™
chmod 644 certs/server.crt
chmod 600 certs/server.key

# é‡å¯æœåŠ¡
systemctl restart customer-service
```

---

## ğŸ“Š æ€§èƒ½æ£€æŸ¥

### CPU å’Œå†…å­˜
```bash
# æŸ¥çœ‹èµ„æºä½¿ç”¨
top -p $(pgrep customer-service)

# é¢„æœŸ:
# CPU: < 5% (ç©ºé—²æ—¶)
# å†…å­˜: < 100MB
```

### æ•°æ®åº“æ€§èƒ½
```bash
# æ£€æŸ¥æ•°æ®åº“å¤§å°
du -h customer_service.db

# æµ‹è¯•æŸ¥è¯¢é€Ÿåº¦
time sqlite3 customer_service.db "SELECT COUNT(*) FROM users;"
```

### ç½‘ç»œè¿æ¥
```bash
# æŸ¥çœ‹å½“å‰è¿æ¥æ•°
ss -tan | grep -E '8080|8443' | wc -l
```

---

## ğŸ” å®‰å…¨åŠ å›ºå»ºè®®

### å‡çº§åˆ°å—ä¿¡ä»»è¯ä¹¦
```bash
# ä½¿ç”¨ Let's Encrypt ç”³è¯·å…è´¹è¯ä¹¦
chmod +x setup-https.sh
./setup-https.sh
```

### é…ç½®è‡ªåŠ¨å¤‡ä»½
```bash
# æ·»åŠ åˆ° crontab
crontab -e

# æ¯å¤©å‡Œæ™¨3ç‚¹å¤‡ä»½æ•°æ®åº“
0 3 * * * cp /root/ubuntu-deploy-ready/customer_service.db /root/backup/db_$(date +\%Y\%m\%d).db
```

### æ—¥å¿—è½®è½¬
```bash
# é™åˆ¶æ—¥å¿—å¤§å°
journalctl --vacuum-size=100M
journalctl --vacuum-time=7d
```

---

## ğŸ“ å®Œæˆç¡®è®¤

éƒ¨ç½²æˆåŠŸçš„æ ‡å¿—:
- âœ… æœåŠ¡çŠ¶æ€: `active (running)`
- âœ… ç«¯å£ç›‘å¬: 8080 (HTTP) + 8443 (HTTPS)
- âœ… æµè§ˆå™¨å¯è®¿é—®: https://elontalk.duckdns.org:8443
- âœ… æ—¥å¿—æ­£å¸¸: æ— é”™è¯¯ä¿¡æ¯
- âœ… æ•°æ®åº“å¯ç”¨: å¯ä»¥æ³¨å†Œ/ç™»å½•
- âœ… WebSocket è¿æ¥: å®æ—¶æ¶ˆæ¯æ­£å¸¸

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `éƒ¨ç½²è¯´æ˜_HTTPSç‰ˆæœ¬.md` - è¯¦ç»†éƒ¨ç½²è¯´æ˜
- `QUICKSTART.md` - å¿«é€Ÿå¼€å§‹æŒ‡å—
- `README.md` - é¡¹ç›®æ€»è§ˆ
- `ä¸Šä¼ æŒ‡å—.md` - æ–‡ä»¶ä¸Šä¼ è¯´æ˜
- `æœ€ç»ˆéƒ¨ç½²æ£€æŸ¥.md` - éƒ¨ç½²æ£€æŸ¥è¦ç‚¹

---

**æ£€æŸ¥æ¸…å•ç‰ˆæœ¬**: v1.0  
**é€‚ç”¨ç³»ç»Ÿ**: Ubuntu 24.04 LTS  
**åˆ›å»ºæ—¶é—´**: 2025-10-15 23:04

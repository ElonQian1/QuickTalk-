# ================================================================
# ELonTalk 客服系统 - 环境配置示例
# ================================================================
# 说明: 复制此文件为 .env 并修改相应配置
# ================================================================

# -------------------- 数据库配置 --------------------
DATABASE_URL=sqlite:customer_service.db
DATABASE_MAX_CONNECTIONS=10
DATABASE_CONNECT_TIMEOUT=8
AUTO_MIGRATE=true
VALIDATE_SCHEMA=true
MIGRATION_MODE=safe
BACKUP_BEFORE_MIGRATE=true

# -------------------- 认证配置 --------------------
# ⚠️  生产环境必须修改此密钥！
JWT_SECRET=your-super-secret-jwt-key-change-this

# -------------------- 服务器配置 --------------------
SERVER_HOST=0.0.0.0
SERVER_PORT=8080

# HTTPS/TLS 配置
HTTPS_ENABLED=true
TLS_MODE=https
TLS_PORT=8443
TLS_DOMAIN=yourdomain.com
TLS_CERT_PATH=certs/server.crt
TLS_KEY_PATH=certs/server.key

# HTTP 到 HTTPS 重定向
REDIRECT_HTTP=true
FORCE_HTTPS=true

# -------------------- 安全配置 --------------------
SECURE_COOKIES=true
STRICT_TRANSPORT_SECURITY=true

# -------------------- 静态文件配置 --------------------
STATIC_FILES_PATH=static
FRONTEND_PATH=static

# -------------------- 跨域配置 --------------------
CORS_ALLOWED_ORIGINS=https://yourdomain.com

# -------------------- 日志配置 --------------------
RUST_LOG=info
LOG_LEVEL=info

# -------------------- 资源限制 --------------------
MAX_UPLOAD_SIZE=10485760
SESSION_TIMEOUT=3600

# -------------------- WebSocket 配置 --------------------
WS_HEARTBEAT_INTERVAL=30
WS_CLIENT_TIMEOUT=60

# -------------------- 性能优化 --------------------
WORKERS=4
BACKLOG=1024
ENV=production

# -------------------- 服务器信息 (可选) --------------------
SERVER_NAME=客服系统
SERVER_IP=0.0.0.0
ADMIN_EMAIL=admin@example.com

# -------------------- DuckDNS 配置 (可选) --------------------
# 如果使用 DuckDNS 动态域名服务
# DUCKDNS_TOKEN=your-duckdns-token

# ==================== ACME 自动证书配置 ====================
# 是否启用 ACME 自动签发/续期（Let's Encrypt）
ACME_ENABLED=false

# ACME 目录 URL
# 生产环境:
ACME_DIRECTORY_URL=https://acme-v02.api.letsencrypt.org/directory
# 测试环境（建议首次使用）:
# ACME_DIRECTORY_URL=https://acme-staging-v02.api.letsencrypt.org/directory

# 管理员邮箱（接收证书到期通知）
ACME_EMAIL=siwmm@163.com

# 域名列表（逗号分隔，支持通配符）
ACME_DOMAINS=elontalk.duckdns.org
# 通配符示例: ACME_DOMAINS=elontalk.duckdns.org,*.elontalk.duckdns.org

# 挑战类型（当前仅支持 dns-01）
ACME_CHALLENGE=dns-01

# 提前续期天数（证书剩余有效期少于此天数将自动续期）
RENEW_BEFORE_DAYS=30

# DuckDNS DNS Provider 配置（DNS-01 挑战必需）
DUCKDNS_DOMAIN=elontalk
DUCKDNS_TOKEN=400bfeb6-b2fe-40e8-8cb6-7d38a2b943ca

# ==================== ACME 使用说明 ====================
# 1. 首次部署建议使用 staging 环境测试，避免触发频率限制
# 2. ACME_ENABLED=true 时，服务启动前会自动检查证书并在需要时签发/续期
# 3. 证书会写入 TLS_CERT_PATH 和 TLS_KEY_PATH 指定的位置
# 4. 服务启动后会自动加载证书
# 5. DuckDNS token 请妥善保管，不要泄露
# 6. 证书有效期 90 天，默认在剩余 30 天时自动续期

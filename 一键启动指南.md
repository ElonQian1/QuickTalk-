# 🚀 QuickTalk 一键启动指南

## 概述

我们已经成功实现了类似 `npm run tauri dev` 的一键原生前后端热重载启动方式！

## 🎯 一键启动命令

### 主要命令 (推荐)

```bash
# 最常用：同时启动前后端热重载开发服务器
npm run dev

# 或者使用我们的脚本
.\start-dev.ps1
```

### 其他命令选项

```bash
# 仅启动后端 (Rust 热重载)
npm run dev:backend-only
.\start-dev.ps1 -BackendOnly

# 仅启动前端 (React 热重载)  
npm run dev:frontend-only
.\start-dev.ps1 -FrontendOnly

# 初始化环境 (首次使用)
npm run setup
.\start-dev.ps1 -Setup

# 构建生产版本
npm run build

# 清理环境
.\start-dev.ps1 -Clean
```

## 🛠️ 技术实现

### 1. 并发启动架构
使用 `concurrently` npm 包同时启动前后端:
- 🦀 **后端**: `cargo watch -x run` (Rust 热重载)  
- ⚛️ **前端**: `vite` (React 热重载)

### 2. 热重载支持
- **后端热重载**: `cargo-watch` 监控 Rust 文件变化，自动重新编译
- **前端热重载**: Vite 内置 HMR (热模块替换)
- **API 代理**: Vite 自动代理 `/api/*` 到 `http://localhost:3030`

### 3. 统一配置
```json
{
  "scripts": {
    "dev": "concurrently \"npm run dev:backend\" \"npm run dev:frontend\" --names \"🦀 Backend,⚛️ Frontend\" --prefix-colors \"yellow,cyan\" --kill-others-on-fail",
    "dev:backend": "cd backend && cargo watch -x run",
    "dev:frontend": "cd frontend-react && vite"
  }
}
```

## 🌟 启动效果

当运行 `npm run dev` 时，您将看到：

```
🦀 Backend  | Starting Rust server with hot reload...
⚛️ Frontend | VITE v4.5.14  ready in 255 ms
⚛️ Frontend | ➜  Local:   http://localhost:5173/
🦀 Backend  | 🦀 正在启动 QuickTalk 纯 Rust 服务器...
🦀 Backend  | Server running on http://localhost:3030
```

## 🔗 访问地址

启动成功后，您可以访问：

- **🌐 React 前端**: http://localhost:5173 (开发服务器，热重载)
- **🔧 Rust 后端**: http://localhost:3030 (API 服务器)
- **📡 API 测试**: http://localhost:3030/api/health

## 📋 开发工作流

### 典型开发流程

1. **首次启动**:
   ```bash
   npm run setup     # 安装所有依赖
   npm run dev       # 启动开发环境
   ```

2. **日常开发**:
   ```bash
   npm run dev       # 一键启动
   # 开始编码，保存文件自动热重载
   ```

3. **分别调试**:
   ```bash
   npm run dev:backend-only    # 仅后端
   npm run dev:frontend-only   # 仅前端
   ```

### 自动化特性

- ✅ **自动重启**: 修改 Rust 代码自动重新编译
- ✅ **热模块替换**: 修改 React 代码即时更新
- ✅ **错误提示**: 编译错误实时显示
- ✅ **API 代理**: 前端请求自动转发到后端
- ✅ **进程同步**: 一个进程崩溃会停止全部

## 🎨 界面展示

```
┌─────────────────────────────────────────────────────────────┐
│ 🚀 QuickTalk 全栈开发环境                                     │
├─────────────────────────────────────────────────────────────┤
│ [🦀 Backend ] Starting Rust server...                      │
│ [⚛️ Frontend] VITE ready in 255ms                          │
│ [🦀 Backend ] Server running on http://localhost:3030     │
│ [⚛️ Frontend] Local: http://localhost:5173/               │
└─────────────────────────────────────────────────────────────┘
```

## 🔧 故障排除

### 常见问题

1. **端口冲突**:
   - 后端端口 3030 被占用 → 修改 `backend/src/main.rs` 中的端口
   - 前端端口 5173 被占用 → 修改 `vite.config.ts` 中的端口

2. **依赖问题**:
   ```bash
   npm run setup        # 重新安装依赖
   cargo install cargo-watch  # 安装 Rust 热重载工具
   ```

3. **编译错误**:
   - Rust 编译错误会在终端显示
   - React 编译错误会在浏览器和终端显示

### 环境要求

- ✅ Node.js >= 16.0.0
- ✅ Rust >= 1.70.0
- ✅ cargo-watch (自动安装)

## 🎉 优势对比

### 传统方式 vs 一键启动

| 操作 | 传统方式 | 一键启动 |
|------|----------|----------|
| 启动后端 | `cd backend && cargo run` | |
| 启动前端 | `cd frontend-react && npm run dev` | `npm run dev` |
| 热重载 | 手动重启 | 自动热重载 |
| 进程管理 | 多个终端窗口 | 统一终端 |
| 错误处理 | 分别查看 | 统一输出 |

## 🚀 未来扩展

可以进一步添加的功能：

- 📊 **性能监控**: 启动时间统计
- 🧪 **自动测试**: 文件变化时运行测试
- 📦 **自动构建**: 推送到生产分支时自动构建
- 🔔 **通知系统**: 编译完成桌面通知
- 🌐 **网络访问**: 自动获取局域网IP用于移动端测试

---

现在您拥有了媲美 Tauri 的一键开发体验！🎯